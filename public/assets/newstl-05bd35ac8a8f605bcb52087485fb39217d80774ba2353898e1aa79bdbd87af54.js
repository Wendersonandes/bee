window.addEventListener("load",function(){"use strict";var e=640,t=550,n=new THREE.WebGLRenderer;n.setSize(e,t);var a=document.getElementById("view_teste");a.appendChild(n.domElement);var o=new THREE.PerspectiveCamera(45,e/t,.1,2e4);o.position.set(0,0,150);var i=new THREE.OrbitControls(o,a),r=new THREE.Scene;r.add(new THREE.AmbientLight(6710886)),r.background=new THREE.Color(16777215);var s=new THREE.DirectionalLight(16777215);s.position.set(0,100,100),r.add(s);var E=new THREE.DirectionalLight(16777215);E.position.set(0,-100,-100),r.add(E);var d=new THREE.MeshPhongMaterial({color:12566463,ambient:12566463,specular:197379}),c=new THREE.Mesh(new THREE.Geometry,d);r.add(c);var l,v,p,m,w=new THREE.Mesh(new THREE.Geometry,d),z=function u(){requestAnimationFrame(u),w.rotation.y+=.002,i.update(),n.clear(),n.render(r,o)};z();var R=function(n){var s=new FileReader;s.addEventListener("load",function(n){var s=n.target.result,E=loadStl(s);r.remove(w),c=new THREE.Mesh(E,d),c.rotation.x=-90*Math.PI/180;var z=(new THREE.Box3).setFromObject(c);console.log(z.min,z.max,z.size(),c.rotation),c.position.y=-(z.max.y-z.size().y/2),c.position.x=-(z.max.x-z.size().x/2),c.position.z=-(z.max.z-z.size().z/2),w=new THREE.Object3D,w.position.set(0,0,0),w.rotation.set(0,0,0),w.add(c),l=z.size().x>z.size().y||z.size().z>z.size().y?z.size().z>z.size().y?z.size().z:z.size().x:z.size().y,v=2*Math.atan(l/400),console.log(v),p=v*(180/Math.PI),o=new THREE.PerspectiveCamera(p,e/t,1,800),o.position.set(0,63.767,300),m=12*(Math.PI/180),o.rotation.set(-m,0,0),i=new THREE.OrbitControls(o,a),r.add(w)},!1),s.readAsArrayBuffer(n)},T=document.getElementById("post_attachment");T.addEventListener("change",function(e){var t=e.target.files[0];R(t)},!1),a.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),a.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files[0];R(t)},!1)},!1);